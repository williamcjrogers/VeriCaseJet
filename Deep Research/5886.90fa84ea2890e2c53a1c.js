"use strict";(self.webpackChunkEgnyte_CommonUI=self.webpackChunkEgnyte_CommonUI||[]).push([[5886],{180695:function(e,t,n){var o=n(762074),a=n(557044);t.Z=function(){return(0,a.Z)({contentRows:[(0,o.t)("storage.actions.async.renamingItemsInBackground"),(0,o.t)("storage.actions.async.okToCloseBrowser")],analyticsEvent:{name:"Async Rename: Dialog shown"}})}},270258:function(e,t,n){n.d(t,{y:function(){return a}});var o=n(667294);function a(e){var t=e.selectionRange;return{onFocus:(0,o.useCallback)((function(e){var n=e.target,o=t.start||0,a=t.end||n.value.length;n.setSelectionRange(o,a)}),[t.start,t.end])}}},25886:function(e,t,n){n.r(t),n.d(t,{default:function(){return s}});var o=n(420790),a=n(232452),r=n(42594),i=n(508226),c=n(862079),l=n(347392);function s(e){var t=e.clone();if(t.collection=e.collection,t.off(),t.cancelOperation=t.cancelOperation.bind(e),(0,r.pL)()){var n=(0,i.c)();t.adapter=new a.Z({documentRoomId:n})}if((0,l.GB)()){var s=(0,l.yT)();t.adapter=new a.Z({workspaceId:s})}o.Z.create(new c.Z({model:t,initialName:e.get("name"),isForRename:!0,disableSubmitWhenNoChanges:["name"],onSuccess:function(){var n=t.toJSON();n.processing=!1,e.set(n)}}))}},862079:function(e,t,n){n.d(t,{Z:function(){return pe}});var o=n(93433),a=n(215671),r=n(143144),i=n(360136),c=n(182963),l=n(661120),s=n(204942),u=n(667294),m=n(366350),p=n(762074),f=n(805252),d=n(783896),h=n(420790),g=n(776327),v=n(19309),b=n(264802),E=n(368354),Z=n(986456),y=n.n(Z),N=n(722332),P=n(414918),C=n(787781),O=n(266606),k=n(680252),R=n(180695),S=n(397404),w=n(821442);function F(e){var t=e.folderName,n=e.onSendPublicLinkClick;return u.createElement(u.Fragment,null,u.createElement("span",null,(0,p.t)("storage.nameModal.notifications.folderCreated",{name:t}),"Â "),u.createElement("span",null,u.createElement(w.Z,{onClick:n},(0,p.t)("storage.nameModal.notifications.shareFolder"))))}var M=n(610861),D=(n(531926),n(175872)),I=n(289098),A=n(529439),L=n(698607),T=n(799532),j=n(531081),W=n(403455),x="truncatedParentPath";function _(e){var t=e.children;return u.createElement(D.l,{"data-tid":"folder-item-name-form"},t)}_.NameField=function(e){var t=e.onFocus;return u.createElement(I.Text,{name:"name",label:(0,p.t)("storage.nameModal.name"),autoFocus:!0,onFocus:t,inline:!1})},_.ParentPathField=function(){var e,t,n,o=(0,W.U$)("parentPath"),a=(0,A.Z)(o,1)[0].value,r=(0,W.U$)(x),i=(0,A.Z)(r,1)[0].value;return u.createElement(L.Z,{tooltip:a,disabled:(e={originalPath:a,truncatedPath:i},t=e.originalPath,n=e.truncatedPath,!(t.length>30&&t!==n))},u.createElement(I.Text,{name:x,label:(0,p.t)("storage.nameModal.location"),startAdornment:u.createElement(T.Z,{icon:j.so}),inline:!1,disabled:!0}))};var U=n(735691);U.Ry().shape({name:U.Z_().folderItemName().required()}),n(270258);var q=n(294184),B=n.n(q),z=n(6587),G=n(23888),H=(0,u.forwardRef)((function(e,t){var n=e.model.get("parentPath"),o=(0,G.EF)(n,15,15);return u.createElement("div",{"data-tid":"location",className:B()("a5pY7D3t8IEI_qKvHljx","control-group")},u.createElement("label",{htmlFor:"location",className:"control-label"},(0,p.t)("storage.nameModal.location")),u.createElement(L.Z,{tooltip:o.length>30&&n,className:"WkinVc6Yj18In8yHMIE4"},u.createElement("div",{className:"vcqGvhBl2dpXCi1Ma9vE"},u.createElement(z.Z,{inputRef:t,disabled:!0,onChange:function(){},id:"location",name:"location",type:"text",className:B()("SH5U4H4BUDMl_UKG91Ce"),autoComplete:"on",value:o,prefix:u.createElement(T.Z,{icon:j.so,className:"ShhO89TWLwdajCuYqxCz"})}))))})),K=n(80373);function V(e){var t,n=e.model,o=e.handle202Status,a=e.onCancel,r=e.onSuccess;return t="folder"===n.get("type")?{title:(0,p.t)("storage.rename.merge.folders.title"),body:(0,p.t)("storage.rename.merge.folders.content"),confirm:(0,p.t)("storage.rename.merge.folders.confirmAction"),processing:(0,p.t)("button.label.sending"),cancel:(0,p.t)("button.label.cancel")}:{title:(0,p.t)("storage.rename.merge.files.title"),body:(0,p.t)("storage.rename.merge.files.content"),confirm:(0,p.t)("storage.rename.merge.files.confirmAction"),processing:(0,p.t)("button.label.sending"),cancel:(0,p.t)("button.label.cancel")},u.createElement(K.Z,{messages:t,onConfirm:function(){(0,S.yK)(),n.save({overwrite:!0,name:n.get("name")},{success:function(){r(),(0,M.GZ)()},error:function(e,t){202===t.status&&o?o():(0,M.GZ)()},patch:!0})},onCancel:function(){a(),(0,M.GZ)()}})}function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){(0,s.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J="RENAME",$="NEW_FOLDER";function Q(){h.Z.hide(),(0,M.Mr)(),(0,R.Z)()}function ee(){return this.props.isForRename?J:$}function te(){var e,t,n,o=this;t=(e={folderName:this.props.model.get("name"),onSendPublicLinkClick:function(){o.props.sendPublicLink(new v.Z.Collection([o.props.model]))}}).folderName,n=e.onSendPublicLinkClick,(0,S.c0)(S.em.success,u.createElement(F,{folderName:t,onSendPublicLinkClick:n}))}function ne(){this.props.collection.unshift(this.props.model),this.props.collection.trigger("prepend",this.props.model)}function oe(){switch(ee.call(this)){case J:O.Z.track(N.Z.MIXPANEL_EVENT.RENAME,Y({Type:this.props.model.get("type"),InitialName:this.props.initialName,Name:this.props.model.get("name")},(0,k.zs)()));break;case $:ne.call(this),te.call(this),O.Z.track(N.Z.MIXPANEL_EVENT.NEW_CREATED,Y({},(0,k.zs)()))}!function(e,t,n){var o;switch(e){case J:o=g.ZP.Events.Storage.FOLDER.RENAME;break;case $:o=g.ZP.Events.Storage.FOLDER.ADD}o&&g.ZP.trigger(o,t,n)}(ee.call(this),this.props.model,(0,E.q)(this.props.initialName)),h.Z.hide(),this.props.onSuccess(this.props.model)}function ae(e,t){var n=this,o=this.props.model.collection.findWhere({path:t.errors[0].resource.path});this.conflict=!0,(0,M.h7)(u.createElement(V,{model:this.props.model,onSuccess:function(){o&&(n.props.model.collection.remove(o),g.ZP.trigger(g.ZP.Events.Storage.FOLDER.REMOVE,o)),oe.call(n)},onCancel:function(){e.set("name",(0,E.q)(n.props.initialName)),h.Z.create(new me(n.props))},handle202Status:Q}))}function re(e,t,n){var o=(0,P.As)(t.responseText);o||(g.ZP.trigger(g.ZP.Events.Storage.NOTIFICATION.SHOW,"error",(0,p.t)("error.unexpected")),h.Z.hide(),o={});var a=o.errors&&o.errors[0]&&o.errors[0].resource&&e.get("type")===o.errors[0].resource.type;409===t.status&&a&&e.isMergeable()&&this.props.isForRename?(h.Z.hide(),ae.call(this,e,o)):n(e,t)}function ie(e,t,n,o){var a=(0,P.As)(o.responseText)||{};202===o.status?Q():!e||y().any(["errors","formErrors","inputErrors"],(function(e){return a[e]&&a[e].length}))?re.call(this,n,o,t):oe.call(this)}function ce(e){var t=this,n=this.props.model;n.once("validated",(function(o){if(o){if(ee.call(t)===J&&(0,f.zD)(n.get("path"))){var a=(0,f.Di)(n.get("path"))?f.JK:f._L;n.set("name","".concat(n.get("name"),".").concat(a))}n.save(null,{success:ie.bind(t,!0,e),error:ie.bind(t,!1,e),patch:!0})}})),n.validate()}function le(){this.props.isForRename&&!this.conflict&&this.props.model.cancelOperation(),h.Z.hide()}function se(){h.Z.hide()}var ue=function(e){(0,i.Z)(m,e);var t,n,s=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,l.Z)(t);if(n){var a=(0,l.Z)(this).constructor;e=Reflect.construct(o,arguments,a)}else e=o.apply(this,arguments);return(0,c.Z)(this,e)});function m(){return(0,a.Z)(this,m),s.apply(this,arguments)}return(0,r.Z)(m,[{key:"UNSAFE_componentWillMount",value:function(){v.Z.history.on("route",se,this)}},{key:"componentWillUnmount",value:function(){v.Z.history.off("route",se,this),le.call(this)}},{key:"getWindowTitle",value:function(){var e,t=this.props.initialName;switch(ee.call(this)){case J:e=(0,p.t)("storage.nameModal.rename",{name:(0,E.q)(t)});break;case $:e=(0,p.t)("storage.nameModal.newFolder")}return e}},{key:"render",value:function(){var e=this.getWindowTitle(),t=this.props,n=t.model,a=t.isForRename,r=t.disableSubmitWhenNoChanges,i=[{name:"name",label:"storage.nameModal.name",autoSelect:!0,autoComplete:!1,selectionRange:{start:0,end:(0,f.zD)(n.get("path"))?n.get("name").length:C.ZP.getNameWithoutExtension(n.get("name")).length}}].concat((0,o.Z)(a?[]:[{name:"parentPath",label:"storage.nameModal.location",component:H}])),c=(0,f.zD)(n.get("path"))?(0,E.q)(n.get("name")):n.get("name");return n.set("name",c),u.createElement(h.Z.Component,{bemModifier:"folder-name",title:e},u.createElement(d.Z,{prefix:"name-modal",className:"no-bottom-margin",key:"form",model:n,fields:i,stateButtonLabels:{default:a?"storage.button.rename":"storage.button.create"},disableSubmitWhenNoChanges:r,onCancel:le.bind(this),onSubmit:ce.bind(this)}))}}]),m}(u.Component);ue.defaultProps={isForRename:!1,onSuccess:b.Z,initialName:""};var me=m.Z.extend({initializeComponent:function(e){return u.createElement(ue,e)}}),pe=me}}]);