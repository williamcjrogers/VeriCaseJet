<div class="context-panel collapsed" id="contextPanel">
  <div class="context-panel-header">
    <h3>
      <i class="fas fa-bolt"></i>
      <span class="context-toggle-label">Quick Actions</span>
    </h3>
    <button class="context-toggle-btn" onclick="toggleContextPanel()" title="Toggle Quick Actions">
      <i class="fas fa-chevron-left" id="contextToggleIcon"></i>
    </button>
  </div>
  <div class="context-panel-content">
    <!-- Selection Info -->
    <div class="context-section" id="selectionSection">
      <div class="context-section-header" onclick="toggleContextSection('selection')">
        <span><i class="fas fa-check-square"></i> Selected
          <span class="selected-count-badge" id="contextSelectedCount">0</span></span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="context-section-body" id="selectionBody">
        <div id="selectedEmailsPreview">
          <div class="context-empty-state">
            <i class="fas fa-mouse-pointer"></i>
            <p>Select emails for actions</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Quick Link Section -->
    <div class="context-section" id="quickLinkSection">
      <div class="context-section-header" onclick="toggleContextSection('quickLink')">
        <span><i class="fas fa-link"></i> Link to Matter / Claim</span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="context-section-body" id="quickLinkBody">
        <label for="linkTypeSelect"></label><select class="quick-link-dropdown" id="linkTypeSelect"
          onchange="onLinkTypeChange()">
          <option value="">Select type...</option>
          <option value="matter">Contentious Matter</option>
          <option value="claim">Head of Claim</option>
        </select>
        <label for="linkTargetSelect"></label><select class="quick-link-dropdown" id="linkTargetSelect"
          style="display: none">
          <option value="">Select target...</option>
        </select>
        <button class="link-btn" id="linkSelectedBtn" onclick="linkSelectedEmails()" disabled>
          <i class="fas fa-link"></i> Link Emails
        </button>
      </div>
    </div>

    <!-- Suggestions & Insights -->
    <div class="context-section" id="aiSuggestionsSection">
      <div class="context-section-header" onclick="toggleContextSection('aiSuggestions')">
        <span><i class="fas fa-lightbulb"></i> VeriCase suggestions</span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="context-section-body" id="aiSuggestionsBody">
        <div id="aiSuggestionsList">
          <div class="context-empty-state">
            <i class="fas fa-lightbulb"></i>
            <p>Select emails for VeriCase suggestions</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Smart Actions -->
    <div class="context-section" id="smartActionsSection">
      <div class="context-section-header" onclick="toggleContextSection('smartActions')">
        <span><i class="fas fa-lightbulb"></i> Smart Actions</span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="context-section-body" id="smartActionsBody">
        <div style="display: flex; flex-direction: column; gap: 0.5rem">
          <button class="btn" onclick="showSimilarEmails()" style="justify-content: flex-start; background: #f0fdf4; color: #166534; border: 1px solid #bbf7d0;">
            <i class="fas fa-search-plus"></i> Show Similar Emails
          </button>
          <button class="btn" onclick="suggestExclusion()" style="justify-content: flex-start; background: #fef3c7; color: #92400e; border: 1px solid #fcd34d;">
            <i class="fas fa-filter"></i> Suggest Exclusion Tag
          </button>
          <button class="btn" onclick="analyzeSelection()" style="justify-content: flex-start; background: #eff6ff; color: #1d4ed8; border: 1px solid #bfdbfe;">
            <i class="fas fa-chart-pie"></i> Analyze Selection
          </button>
        </div>
      </div>
    </div>

    <!-- Bulk Actions -->
    <div class="context-section" id="bulkActionsSection">
      <div class="context-section-header" onclick="toggleContextSection('bulkActions')">
        <span><i class="fas fa-bolt"></i> Bulk Actions</span>
        <i class="fas fa-chevron-down"></i>
      </div>
      <div class="context-section-body" id="bulkActionsBody">
        <div style="display: flex; flex-direction: column; gap: 0.5rem">
          <button class="btn" onclick="bulkSetCategory()" style="justify-content: flex-start">
            <i class="fas fa-folder"></i> Set Category
          </button>
          <button class="btn" onclick="bulkAddKeywords()" style="justify-content: flex-start">
            <i class="fas fa-tag"></i> Add Keywords
          </button>
          <button class="btn" onclick="markAsExcluded()" style="justify-content: flex-start; background: #fef2f2; color: #991b1b; border: 1px solid #fecaca;">
            <i class="fas fa-ban"></i> Mark as Excluded
          </button>
          <button class="btn" onclick="bulkExportSelected()" style="justify-content: flex-start">
            <i class="fas fa-download"></i> Export
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
