"use strict";(self.webpackChunkEgnyte_CommonUI=self.webpackChunkEgnyte_CommonUI||[]).push([[3896],{783896:function(e,t,r){r.d(t,{Z:function(){return P}});var o=r(215671),n=r(143144),a=r(497326),i=r(360136),s=r(182963),c=r(661120),l=r(204942),u=r(19309),f=r(667294),p=r(986456),d=r.n(p),m=r(762074),h=r(79564),v=r(733929),E=r(294184),y=r.n(E);function S(e){var t=this.inputRef;this.props.field.preventAutocomplete&&!this.props.field.inputReadOnly&&e.target.removeAttribute("readonly"),this.props.field.autoSelect&&(this.props.field.selectionRange&&t.setSelectionRange?t.setSelectionRange(this.props.field.selectionRange.start||0,this.props.field.selectionRange.end||t.value.length):u.Z.$(t).select()),this.props.clearErrors()}function Z(e){this.props.model.set(this.props.field.name,e.target.value),"checkbox"===this.props.field.type&&this.props.model.set(this.props.field.name,e.target.checked),this.props.clearErrors()}var g=function(e){(0,i.Z)(l,e);var t,r,a=(t=l,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,c.Z)(t);if(r){var n=(0,c.Z)(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return(0,s.Z)(this,e)});function l(){return(0,o.Z)(this,l),a.apply(this,arguments)}return(0,n.Z)(l,[{key:"render",value:function(){var e,t=this,r=this.props,o=r.getError,n=r.model,a=r.field,i=o(),s=n.validation,c=(0,m.t)(a.tooltip),l="",u="";i&&(e=f.createElement("div",{className:"meta"},f.createElement("div",{"data-tid":"error",className:"error"},i)),l="error");var p=s&&s[a.name]||[];p=d().isArray(p)?p:[p],d().some(p,{required:!0})&&(u="required");var v=n.get(a.name),E=a.readOnly?f.createElement("span",{className:"input-read-only"},"function"==typeof a.format?a.format(v,n):v):f.createElement("input",{type:a.type||"text",name:a.name,defaultValue:v,className:a.preventAutocomplete?"autocomplete-prevention":"",readOnly:a.inputReadOnly||a.preventAutocomplete,placeholder:(0,m.t)(a.placeholder),onFocus:S.bind(this),onChange:Z.bind(this),ref:function(e){t.inputRef=e},autoComplete:"password"===a.type||!1===a.autoComplete?"off":void 0});return f.createElement("div",{"data-tid":"control-group",className:y()("control-group",l,u,a.className)},f.createElement("label",{className:"control-label"},(0,m.t)(a.label),c&&f.createElement(h.Z,null,c)),f.createElement("div",{className:"controls"},E,e))}}]),l}(f.Component),R=(0,v.Z)(g),b=r(460294),k=r(776327),C=r(968141),N=r(619755),B=r.n(N),A=r(32283),O=r(888249),T=r(579621),x=r(777814);var F=function(e){(0,i.Z)(p,e);var t,r,u=(t=p,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,o=(0,c.Z)(t);if(r){var n=(0,c.Z)(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return(0,s.Z)(this,e)});function p(){var e;(0,o.Z)(this,p);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e=u.call.apply(u,[this].concat(r)),(0,l.Z)((0,a.Z)(e),"state",{isSynced:!1}),(0,l.Z)((0,a.Z)(e),"setSyncedState",(function(){e.setState({isSynced:!0})})),(0,l.Z)((0,a.Z)(e),"onCancel",(function(t){var r=e.props.onCancel;t.preventDefault(),r(t)})),(0,l.Z)((0,a.Z)(e),"onSubmit",(function(){var t=e.props,r=t.model,o=t.onSubmit,n=t.onSuccess,i=t.onAccepted,s=t.onError;e.notificationsRef.reset(),d().isFunction(o)?o(e.setErrorsFromServer):(r.once("validated",(function(t){t&&r.save(null,{success:n,error:function(t,o){if(202===o.status&&d().isFunction(i))i();else{for(var n=d().isFunction(s)?s:e.setErrorsFromServer,c=arguments.length,l=new Array(c>2?c-2:0),u=2;u<c;u++)l[u-2]=arguments[u];n.call.apply(n,[(0,a.Z)(e),r,o].concat(l))}}})})),r.validate())})),(0,l.Z)((0,a.Z)(e),"setErrorsFromServer",(function(t,r){var o,n=e.props.prefix,a={};try{var i=r.responseText;o=d().isFunction(t.parseErrorResponse)?t.parseErrorResponse(i,r):JSON.parse(i)}catch(e){o={}}(0,m.Gg)("formErrors.".concat(o.error_code))&&k.ZP.trigger(k.ZP.Events.Storage.NOTIFICATION.SHOW,"error",(0,m.t)("formErrors.".concat(o.error_code))),o.inputErrors&&Object.keys(o.inputErrors).forEach((function(t){a[t]=o.inputErrors[t].map((function(e){var t=(0,m.t)("formErrors.".concat(e.code));return t==="formErrors.".concat(e.code)?e.msg:t})).join(", "),e.fieldRefs[t]?e.fieldRefs[t].setState({serverError:a[t]}):k.ZP.trigger("form:".concat(n,":notifications:show"),"error","[".concat(t,"] ").concat(a[t]))}));var s=o.errors||o.formErrors;s&&s.length&&s.forEach((function(e){var t=(0,m.t)("formErrors.".concat(e.code));k.ZP.trigger("form:".concat(n,":notifications:show"),"error",t==="formErrors.".concat(e.code)?e.msg:t)})),(s||o.inputErrors||o.error_code)&&(e.stateButtonRef&&e.stateButtonRef.updateState(b.Z.STATES.ERROR),e.scrollToError(e.rootRef))})),(0,l.Z)((0,a.Z)(e),"preventNativeSubmit",(function(e){return e.preventDefault(),!1})),(0,l.Z)((0,a.Z)(e),"updateStateButton",(function(t,r){var o=e.props.fields,n=d().some(o.map((function(t){return!(!e.fieldRefs[t.name]||!e.fieldRefs[t.name].getError||t.name===r)&&e.fieldRefs[t.name].getError()})));t&&!n||e.scrollToError(),e.stateButtonRef&&e.stateButtonRef.updateState(!t||n?b.Z.STATES.ERROR:e.getButtonState())})),e}return(0,n.Z)(p,[{key:"UNSAFE_componentWillMount",value:function(){var e=this.props.model;this.origModel=e.toJSON(),this.fieldRefs={}}},{key:"componentDidMount",value:function(){var e=this.props.model;e.on("validated",this.updateStateButton),e.on("sync",this.setSyncedState)}},{key:"componentWillUnmount",value:function(){var e=this.props.model;e.off("validated",this.updateStateButton),e.off("sync",this.setSyncedState)}},{key:"getButtonState",value:function(){var e=this.props.pending,t=this.state.isSynced;return e?b.Z.STATES.PROCESSING:t?b.Z.STATES.SUCCESS:b.Z.STATES.DEFAULT}},{key:"isDisabledSubmitButton",value:function(){var e=this.props.disableSubmitWhenNoChanges;return d().isArray(e)?this.equalAttributes(e):e&&!this.hasModelChanged()}},{key:"equalAttributes",value:function(e){var t=this,r=this.props.model;return d().every(e,(function(e){return t.origModel[e]===r.get(e)}))}},{key:"hasModelChanged",value:function(){var e=this.props.model;return!!d().keys(e.changed).length&&!d().isEqual(this.origModel,e.toJSON())}},{key:"scrollToError",value:function(){var e=B()(this.rootRef).find(".control-group.error"),t=e.length?e.first():B()(this.rootRef).find(".notifications");if(t.length){var r=t.parents().filter((function(){var e=B()(this),t=e.css("overflow-y");return"auto"===t||"scroll"===t||e.is("body")}));(0,A.X)(r[0],{top:t.offset().top-100,behavior:"smooth"})}}},{key:"render",value:function(){var e=this,t=this.props,r=t.fields,o=t.model,n=t.prefix,a=t.className,i=t.stateButtonLabels,s=t.footerLink,c=t.onCancel,l=t.submitButton,u=t.cancelLabel,p=r.map((function(t){var r={field:t,model:o,key:t.name,ref:function(r){e.fieldRefs[t.name]=r},onClearErrors:e.updateStateButton};if(t.component){var n=t.component;return f.createElement(n,d().extend(r,t.componentProps))}return f.createElement(R,r)})),h={processing:x.b},v=f.createElement(b.Z,{type:"submit",onClick:this.onSubmit,icon:h,ref:function(t){e.stateButtonRef=t},text:i,disabled:this.isDisabledSubmitButton()});return f.createElement("form",{className:y()("form-horizontal","row-fluid",n&&"".concat(n,"-form"),a),ref:function(t){e.rootRef=t},onSubmit:this.preventNativeSubmit,"data-tid":"form"},f.createElement(C.Z,{prefix:"form:".concat(n),key:"notifications",ref:function(t){e.notificationsRef=t}}),f.createElement("fieldset",{className:"stripped"},p),f.createElement("footer",null,s&&f.createElement("a",{href:s.url,className:"btn btn-link",target:s.target},s.label),f.createElement("div",{className:y()("pull-right","TfC9B85IQBoCGlMktLgX")},c&&f.createElement(T.Z,{type:T.Z.SECONDARY,onClick:this.onCancel},(0,m.t)(u||"button.label.cancel")),l||v)))}}]),p}(f.Component);F.defaultProps={pending:!1,prefix:"",className:"",submitButton:null,cancelLabel:"",onSubmit:void 0,onSuccess:function(){},onCancel:void 0,onAccepted:void 0,onError:void 0,stateButtonLabels:{},disableSubmitWhenNoChanges:!1,footerLink:void 0};var P=(0,O.Z)(F)},733929:function(e,t,r){var o=r(487462),n=r(215671),a=r(143144),i=r(497326),s=r(360136),c=r(182963),l=r(661120),u=r(204942),f=r(667294),p=(r(19309),r(762074)),d=r(178820),m=r(108679),h=r.n(m);t.Z=function(e){var t=function(t){(0,s.Z)(h,t);var r,d,m=(r=h,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(r);if(d){var o=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function h(){var e;(0,n.Z)(this,h);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e=m.call.apply(m,[this].concat(r)),(0,u.Z)((0,i.Z)(e),"state",{formError:null,serverError:null}),(0,u.Z)((0,i.Z)(e),"setValidationErrors",(function(t,r,o){var n=e.props.field,a=Object.keys(o).filter((function(e){return 0===e.indexOf(n.name)})).shift();e.setState({formError:o[n.name]||o[a]})})),(0,u.Z)((0,i.Z)(e),"clearErrors",(function(){var t=e.props,r=t.onClearErrors,o=t.field;e.setState({formError:!1,serverError:!1}),r(!0,o.name)})),(0,u.Z)((0,i.Z)(e),"getError",(function(){var t=e.state,r=t.formError,o=t.serverError;if(r){var n=r.key||r,a=r.args||{};return(0,p.t)("error.".concat(n),a)}if(o)return o})),e}return(0,a.Z)(h,[{key:"componentDidMount",value:function(){this.props.model.on("validated",this.setValidationErrors)}},{key:"componentWillUnmount",value:function(){this.props.model.off("validated",this.setValidationErrors)}},{key:"render",value:function(){var t={clearErrors:this.clearErrors,getError:this.getError};return f.createElement(e,(0,o.default)({},this.props,t))}}]),h}(f.Component);return h()(t,e),t.displayName="WithErrors(".concat((0,d.Z)(e),")"),t.defaultProps={onClearErrors:function(){}},t}}}]);