"use strict";(self.webpackChunkEgnyte_CommonUI=self.webpackChunkEgnyte_CommonUI||[]).push([[6347],{863063:function(e,t,n){n.d(t,{queryKeys:function(){return E},useAccessRequest:function(){return b},useAccessRequestLimit:function(){return v},useAccessRequestReject:function(){return y},useAccessRequestsList:function(){return O},useApproveAccessRequestWithPermission:function(){return P}});var r=n(23661),o=n(240701),i=function(){return(0,r.ZP)(o.Z.REQUEST_ACCESS.LIMIT)},s=function(e){return(0,r.ZP)(o.Z.REQUEST_ACCESS.ROOT,{method:"POST",body:e})},a=n(204942),c=n(145218),l=n(190544),u=n(221842),m=n.n(u),d=n(77259);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var E={ACCESS_REQUEST_LIMIT:"access-request-limit",ACCESS_REQUEST_LIST:"access-request-list"},v=function(){return(0,c.useQuery)({queryKey:E.ACCESS_REQUEST_LIMIT,queryFn:i})},O=function(e){var t=e.id,n=e.options,i=void 0===n?{}:n;return(0,c.useQuery)(f({queryKey:[E.ACCESS_REQUEST_LIST,t],queryFn:function(){return function(e){return(0,r.ZP)(o.Z.REQUEST_ACCESS.LIST(e))}(t)},staleTime:10*l.NO},i))},b=function(){return(0,c.useMutation)({mutationFn:s})},y=function(e,t){var n=(0,c.useQueryClient)();return(0,c.useMutation)({mutationFn:function(){return function(e,t){return(0,r.ZP)(o.Z.REQUEST_ACCESS.REJECT(e,t),{method:"POST"})}(e,t)},onSuccess:function(){n.invalidateQueries(E.ACCESS_REQUEST_LIST)}})},P=function(e,t){var n=e.id,i=e.folderAccessRequestId,s=e.permissionValue,a=e.emailFolderAccessRequestId,l=e.path,u=e.documentRoomId,p=(0,c.useQueryClient)(),v=(0,d.pe)({id:n,path:l,documentRoomId:u}).refresh;return(0,c.useMutation)(f({mutationFn:function(){return function(e){var t=e.id,n=e.permissionValue,i=e.emailFolderAccessRequestId;return(0,r.ZP)(o.Z.REQUEST_ACCESS.APPROVE(t,i),{method:"POST",body:{permission:n}})}({id:i,permissionValue:s,emailFolderAccessRequestId:a})}},m()({onSuccess:function(){p.invalidateQueries(E.ACCESS_REQUEST_LIST),v(),(0,d.Ce)({folderPath:l})}},t)))}},63661:function(e,t,n){n.d(t,{JO:function(){return a},P_:function(){return o},Wj:function(){return r},ej:function(){return s},mn:function(){return i}});var r={EXTERNAL_ADS:"EXTERNAL_ADS",EXTERNAL_LDAP:"EXTERNAL_LDAP",EXTERNAL_SAML:"EXTERNAL_SAML",INTERNAL_LDAP:"INTERNAL_LDAP"},o={KEEP:"KEEP_ORIGINAL",INHERIT:"INHERIT_FROM_PARENT",ENFORCE_INHERITANCE:"ENFORCE_INHERIT_FROM_PARENT"},i={NOONE:"NOONE",POWER:"POWER",ALL:"ALL",STANDARD:"STANDARD"},s={EGNYTE:"EGNYTE",AZURE:"AZURE",AMAZON_KMS:"AWSKMS"},a={EGNYTE:"EGNYTE",AZURE:"AZURE",S3:"S3",GCS:"GCS",ORACLE:"ORACLE"}},723756:function(e,t,n){n.d(t,{Z:function(){return _t}});var r=n(204942),o=n(776327),i=n(667294),s=n(610861),a=n(266606),c=n(680252),l=n(93433),u=n(153672),m=n(762074),d=n(141797),p=n(32570),f=n(381859),E=n(77259),v=n(863063),O=n(451090),b=n(460474),y=n(529439),P=n(99815),g=n(579621),R=n(722610),S=n(528058);function Z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var A="pIJnpUTpeRDGUArphV_m",h=n(487462),C=n(354111),N=n(839470),D=function(e){return!(0,P.kO)(e)||e.enabled},j=function(e){return(0,P.kO)(e)&&!1===e.enabled},w=n(307179),T=n(930862),k=n(499345),_=n(652421),M=n(555200);function F(e){var t=(0,M.WX)().permissionStatuses;return e?t[e]:void 0}var L=(0,m.nD)("storage.folderPermissions");function q(e){var t,n,r,o,s,a,c=(t=e.item,n=e.enabled,r=e.isInvited,o=(0,P.kO)(t),s=(0,P.ny)(t),a=F(t.id),o&&!n?{content:L("label.deactivated"),color:_.Z.RED}:(null==a?void 0:a.mutation)===S.lZ.CHANGED?{content:L("label.changedFrom",{status:i.createElement("span",{className:"B9wWoNBPZNDiIKdkWmfQ"},a.oldPermission)}),color:_.Z.BLUE}:(null==a?void 0:a.mutation)===S.lZ.ADDED?{content:L("label.added"),color:_.Z.BLUE}:(null==a?void 0:a.mutation)===S.lZ.USER_ADDED?{content:L("label.userAdded"),color:_.Z.BLUE}:o&&!s?{content:L("label.nonEmployee"),color:_.Z.COOL_GRAY}:r?{content:L("label.invited"),color:_.Z.BLUE}:null);return i.createElement(i.Fragment,null,c&&i.createElement("div",{className:"sFFJUxF_h3JRywxBVFTL"},i.createElement(_.Z,{uppercase:!1,color:c.color,size:_.Z.sizes.MEDIUM},c.content)))}var U=function(e){var t=e.row,n=t.original,o=t.index,s=e.column.props.permissions.at(o);if(void 0===s)return i.createElement(i.Fragment,null);var a=(0,P.YF)(s).toLowerCase(),c=(0,w.oY)(n),l=function(e){return!(!(0,P.kO)(e)||!e.isInvited)}(n),u=function(e){return(0,P.kO)(e)?e.picture:null}(n),m=D(n);return i.createElement("div",{className:"dX64h_IsHuuHt3n1yD_Y"},i.createElement(T.Z,(0,h.default)({size:T.Z.sizes.S,src:u},(0,r.Z)({},a,n))),i.createElement(k.Z,null,c),i.createElement(q,{item:s,enabled:m,isInvited:l}))},x=n(676409),G=n(809742),Y=(0,i.createContext)(void 0);function B(e){var t=e.children,n=(0,i.useState)(null);return i.createElement(Y.Provider,{value:n},t)}function z(){var e=(0,i.useContext)(Y);return(0,y.Z)(e,2)[1]}function Q(e){var t,n=e.type,r=e.children,o=e.withCloseButton,s=void 0===o||o,a=(t=z(),(0,i.useCallback)((function(){t(null)}),[t]));return i.createElement("div",{className:"pjoljzmK22qmClk02a0Q"},i.createElement(G.Z,{type:n,fullWidth:!0,onCloseButtonClick:s?a:void 0},r))}var H="k1lpuqYDuDui5cFKE16g";function V(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userName,n=e.groupName;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.addedToGroup",{context:n&&t&&"withInfo",name:i.createElement("span",{className:H},t),group:i.createElement("span",{className:H},n)}))}function W(e){var t=e.inheritsPermissions;return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.inheritance.notifications.error",{context:t?"add":"remove"}))}function K(e){var t=e.inheritsPermissions,n=e.keepParentPermissions,r=void 0!==n&&n;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.inheritance.notifications.success",{context:t?"added":!t&&r?"removedKeep":"removedDiscard"}))}var J=(0,m.nD)("storage.folderPermissionsModal");function X(){return i.createElement(Q,{type:G.Z.types.INFO,withCloseButton:!1},J("notifications.modificationIsNotAllowed",{owners:i.createElement("span",{className:H},J("label.owners")),admins:i.createElement("span",{className:H},J("label.administrators"))}))}function $(e){var t=e.type;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.grantPermission.successMessage",{context:t}))}function ee(e){var t=e.displayName;return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.grantPermission.errorMessage",{name:i.createElement("span",{className:H},t)}))}function te(e){var t=e.displayName,n=e.isGroup,r=void 0!==n&&n;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.removePermission.successMessage",{name:i.createElement("span",{className:H},t),context:r?"group":"user"}))}function ne(){return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.removePermission.errorMessage"))}function re(e){var t=e.displayName;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.updatePermission.successMessage",{name:i.createElement("span",{className:H},t)}))}function oe(){return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.updatePermission.errorMessage"))}function ie(e){var t=e.errorMessage;return i.createElement(Q,{type:G.Z.types.ERROR},t||(0,m.t)("error.default"))}function se(){return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.requestDenied"))}function ae(){return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.requestApproved"))}function ce(){return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.requestNotApproved"))}function le(){return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("storage.folderPermissions.requestNotDenied"))}function ue(){return i.createElement(Q,{type:G.Z.types.ERROR},(0,m.t)("error.FAILOVER_WRITES_FORBIDDEN"))}function me(){var e,t=(e=(0,i.useContext)(Y),(0,y.Z)(e,1)[0]);return i.createElement(i.Fragment,null,t)}var de=n(154177),pe=n(500140),fe=n(33292),Ee=n(900774),ve=n(636343),Oe=n(609063),be=n(326269);function ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ye(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e){var t=e.row.index,n=e.column.props,r=n.permissions,o=n.isModificationAllowed,s=r.at(t),l=(0,Ee.m)(),u=l.id,m=l.path,d=l.documentRoomId,p=l.isInInactiveContainer,f=(0,E.I4)({id:u,path:m,documentRoomId:d}).mutate,v=(0,E.nJ)({id:u,path:m,documentRoomId:d}).mutate,O=z(),b=(0,ve.s)().addStatuses,y=(0,x.m5)(),g=(0,fe.Z)({id:u,path:m,documentRoomId:d});if(void 0===s)return i.createElement(i.Fragment,null);var R=(0,P.hE)(s),Z=null==s?void 0:s.permission,I=!D(s);return o&&R?i.createElement(Oe.Z,{item:s,onChange:function(e){var t=function(e,t){return(0,P.kO)(e)?{users:[{id:e.id,local:!(0,P.fP)(e),username:e.username,permission:t}],groups:[]}:{groups:[{id:e.id,name:e.name,permission:t}],users:[]}}(s,e);f(t,{onSuccess:function(){s.id&&b([{id:s.id,mutation:S.lZ.CHANGED,oldPermission:s.permission}]),a.Z.track(S.FP.MODIFY,Pe({"initial permission":s.permission,"granted permission":e},(0,c.zs)())),O(i.createElement(re,{displayName:(0,P.oY)(s)}))},onError:function(e){var t=function(){if(y)return i.createElement(ue,null);var t=(0,de.k0)(e)&&(0,pe.oA)(e.data)&&(0,pe.mo)(e.data);return t?i.createElement(ie,{errorMessage:t.msg}):i.createElement(oe,null)}();O(t)}})},onAddToGroup:function(e,t){v({userId:s.id,groupId:e},{onSuccess:function(){b([{id:e,mutation:S.lZ.USER_ADDED}]),a.Z.track(S.FP.ADD_TO_GROUP,Pe({"From permission list":!0},(0,c.zs)())),O(i.createElement(V,{userName:(0,P.oY)(s),groupName:t}))},onError:function(){O(y?i.createElement(ue,null):i.createElement(ie,null))}})},isUserDisabled:I,groups:g,isInInactiveContainer:p}):R?i.createElement(be.O,{permission:Z}):i.createElement(be.d,null)}var Re=n(145987),Se=n(294184),Ze=n.n(Se),Ie=n(555492),Ae=n(535801),he=5*n(190544).NO,Ce=n(225364),Ne=n(799532),De=n(4845),je=n(80373),we=(0,m.nD)("storage.folderPermissionsModal.deleteModal");function Te(e){var t=e.displayName,n=e.onSubmit,r=e.isGroup,o=void 0!==r&&r;return i.createElement(je.Z,{onCancel:s.GZ,onConfirm:function(){n(),a.Z.track(S.FP.DELETE,(0,c.zs)()),(0,s.GZ)()},messages:{title:we("title"),body:i.createElement(i.Fragment,null,i.createElement("p",null,we("info",{context:o&&"group"})),i.createElement("p",null,we("revoke",{userName:i.createElement("span",{className:"QFE0qkHLTs8KDpwJeYad"},t)}))),cancel:(0,m.t)("button.label.cancel"),confirm:we("deleteConfirmationButton")},confirmButtonVariant:g.Z.variants.DESTRUCTIVE})}function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Me(e){var t=e.permission,n=(0,Ee.m)(),r=n.id,o=n.path,a=n.documentRoomId,c=z(),l=(0,x.m5)(),u=(0,E.I4)({id:r,path:o,documentRoomId:a,options:{onSuccess:function(){c(i.createElement(te,{isGroup:(0,P.S_)(t),displayName:(0,P.oY)(t)}))},onError:function(e){var t=function(){if(l)return i.createElement(ue,null);var t=(0,de.k0)(e)&&(0,pe.oA)(e.data)&&(0,pe.mo)(e.data);return t?i.createElement(ie,{errorMessage:t.msg}):i.createElement(ne,null)}();c(t)}}}).mutate;return i.createElement(De.Z,{onClick:function(){return function(e){var t=e.displayName,n=e.isGroup,r=void 0!==n&&n,o=e.onSubmit;(0,s.Ll)(i.createElement(Te,{isGroup:r,displayName:t,onSubmit:o}),{shouldCloseOnEsc:!1,shouldCloseOnOverlayClick:!1,onRequestClose:function(){(0,s.GZ)()}})}({displayName:(0,P.oY)(t),isGroup:(0,P.S_)(t),onSubmit:function(){return u((0,P.FJ)(_e(_e({},t),{},{permission:E._I.NONE})))}})},"aria-label":"remove",icon:Ce.gt,variant:Ne.Z.variants.ERROR})}var Fe=["children","row","className","isModificationAllowed"];function Le(e){var t=e.children,n=e.row,r=e.className,o=e.isModificationAllowed,s=(0,Re.Z)(e,Fe),a=(0,Ie.Z)(),c=a.isHovered,l=a.hoverProps,u=n.original,m=function(e){var t=F(e),n=(0,i.useState)(!1),r=(0,y.Z)(n,2),o=r[0],s=r[1];return(0,i.useEffect)((function(){if(t){var e=Date.now()-t.timestamp;if(!(e>he)){s(!0);var n=setTimeout((function(){s(!1),clearTimeout(n)}),he-e);return function(){return clearTimeout(n)}}}}),[t]),o}(u.id),d=(0,P.hE)(u),p=o&&d;return i.createElement(Ae.X2,(0,h.default)({row:n,isHighlighted:m},l,s,{className:Ze()("SDTGIWKcFDE2tJKeHcFW",r)}),t,c&&i.createElement(Ae.FK,null,p&&i.createElement(Me,{permission:u})))}var qe=(0,i.memo)(Le),Ue=(0,m.nD)("storage.folderPermissions"),xe={NAME:"name",PERMISSION:"permission"},Ge=function(e){var t=e.permissions,n=e.isModificationAllowed,r=e.isLoading,o=void 0!==r&&r,s=(0,i.useState)({sortBy:void 0,sortDirection:void 0}),a=(0,y.Z)(s,2),c=a[0],l=a[1],u=(0,i.useMemo)((function(){return[{accessor:xe.NAME,Header:Ue("label.name"),Cell:U,minWidth:250,width:415,props:{permissions:t}},{accessor:xe.PERMISSION,Header:Ue("label.permissions"),Cell:ge,props:{isModificationAllowed:n,permissions:t}}].filter(Boolean)}),[n,t]),m=(0,i.useCallback)((function(e){return i.createElement(qe,(0,h.default)({},e,{isModificationAllowed:n}))}),[n]),d=(0,i.useMemo)((function(){return t.sort((e=c,function(t,n){var r=0;if(e.sortBy&&1===[t,n].filter((function(e){return j(e)})).length)return j(t)?1:-1;switch(e.sortBy){case"name":r=(0,P.oY)(t).localeCompare((0,P.oY)(n));break;case"permission":r=t.permission.localeCompare(n.permission);break;default:void 0!==t.originalIndex&&void 0!==n.originalIndex&&(r=t.originalIndex>n.originalIndex?1:-1)}return e.sortDirection&&"ASC"!==e.sortDirection?-r:r}));var e}),[t,c]),p=(0,i.useCallback)((function(e){return l(e)}),[]);return i.createElement(i.Fragment,null,i.createElement("p",{className:"fmSQpo1wefCOxO_AYGvp eugzcnL4uVMlgbRkfTqa"},Ue("label.grantedPermissions")),i.createElement(f.Z,null),i.createElement(C.Z,{columns:u,data:d,className:"s0XY77d3BhYKYmhCQ7Qq",features:{sort:!0,columnResize:!0},Row:m,isLoading:o,configuration:{getRowId:function(e){return String(e.id)||(0,P.S_)(e)&&e.name||(0,N.Z)()}},manualSortBy:!0,onSort:p}))};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ze=function(e){return e.map((function(e){var t,n,r;return Be(Be({},e),{},{type:S.BX.USER,picture:null==e||null===(t=e._self)||void 0===t||null===(n=t.linkedResources)||void 0===n||null===(r=n.itemAvatar)||void 0===r?void 0:r.url})}))},Qe=n(115861),He=n(364687),Ve=n.n(He),We=n(403455),Ke=n(534733),Je=n(531926),Xe=n(441680),$e=n(51505),et=n(169060),tt=n(244507),nt=n(495032);function rt(e){var t=e.displayName;return i.createElement(Q,{type:G.Z.types.SUCCESS},(0,m.t)("storage.folderPermissions.grantPermission.permissionAlreadyExists",{name:i.createElement("span",{className:H},t)}))}function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var st=(0,m.nD)("storage.folderPermissionsModal");function at(e){var t=e.permissions,n=void 0===t?[]:t,r=(0,Ee.m)(),o=r.id,s=r.path,l=r.name,u=r.documentRoomId,m=r.isInInactiveContainer,d=(0,E.I4)({id:o,path:s,documentRoomId:u,options:{}}).mutateAsync,p=(0,E.nJ)({id:o,path:s,documentRoomId:u}).mutateAsync,f=(0,x.KN)(),v=z(),O=(0,ve.s)().addStatuses,b=(0,x.m5)(),y=function(){var e=(0,Qe.Z)(Ve().mark((function e(t,r){var o,s,u,m,E,y,g,R,Z;return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=t.usersOrGroups,s=t.permission,u=t.groupId,m=r.setSubmitting,E=r.resetForm,o){e.next=4;break}return e.abrupt("return");case 4:if(!(y=o[0].value).id||!n.find((function(e){return e.id===y.id}))){e.next=9;break}return O([{id:y.id,mutation:S.lZ.NONE}]),v(i.createElement(rt,{displayName:(0,P.oY)(y)})),e.abrupt("return");case 9:if(!u||!(0,P.kO)(y)){e.next=22;break}return e.prev=10,e.next=13,p({userId:y.id,groupId:u},{onSuccess:function(){a.Z.track(S.FP.ADD_TO_GROUP,it({"From user invite":!0},(0,c.zs)()))},onError:function(){v(b?i.createElement(ue,null):i.createElement(ie,null))}});case 13:O([{id:u,mutation:S.lZ.USER_ADDED}]),v(i.createElement(V,{userName:(0,w.Gf)(y),groupName:s})),E(),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(10),m(!1);case 21:return e.abrupt("return");case 22:if(!(0,P.kO)(y)||y.role!==Ke.$A.STANDARD){e.next=28;break}return e.next=25,(0,Xe.My)({usersEmails:[y.email||y.displayEmail||y.unverifiedEmail||""],folderName:l,variant:Xe.ZC.ADD});case 25:if(e.sent){e.next=28;break}return e.abrupt("return");case 28:if(!(0,P.S_)(y)){e.next=41;break}return e.next=31,f(y);case 31:if(void 0!==(g=e.sent)){e.next=35;break}return v(i.createElement(ie,null)),e.abrupt("return");case 35:if(!g){e.next=41;break}return e.next=38,(0,Xe.sx)({groupNames:[y.name]});case 38:if(e.sent){e.next=41;break}return e.abrupt("return");case 41:return R=(0,P.FJ)(it(it({},y),{},{permission:s})),e.prev=42,e.next=45,d(R);case 45:y.id&&O([{id:y.id,mutation:S.lZ.ADDED}]),E(),a.Z.track(S.FP.ADD,it({"granted permission":s},(0,c.zs)())),v(i.createElement($,{type:(0,P.kO)(y)?S.BX.USER:S.BX.GROUP})),e.next=56;break;case 51:e.prev=51,e.t1=e.catch(42),m(!1),Z=function(){if(b)return i.createElement(ue,null);var t=(0,de.k0)(e.t1)&&(0,pe.oA)(e.t1.data)&&(0,pe.mo)(e.t1.data);return t?i.createElement(ie,{errorMessage:t.msg}):i.createElement(ee,{displayName:(0,P.oY)(y)})}(),v(Z);case 56:case"end":return e.stop()}}),e,null,[[10,18],[42,51]])})));return function(t,n){return e.apply(this,arguments)}}(),g={usersOrGroups:[],permission:nt.n.VIEWER.value,groupId:""},R=(0,et.Z)({id:o,path:s,documentRoomId:u}),Z=(0,x.nG)().openModal,I=(0,i.useCallback)((function(e){Z({onClose:function(){return e("usersOrGroups",[])}})}),[Z]);return i.createElement("div",null,i.createElement(We.J9,{onSubmit:y,initialValues:g},(function(e){var t,n=e.setFieldValue,r=e.values,o=e.errors;return i.createElement(We.l0,{className:"dbI838hHd_MIqCFKPKd0"},i.createElement(tt.Z,{setValue:n,values:r,errors:o,openUserInvitationModal:function(){return I(n)},groups:R,isInInactiveContainer:m}),i.createElement("div",{className:"me_Zf3wkKWjYYh4nu2cm"},i.createElement(Je.Z,{disabled:!(null!==(t=r.usersOrGroups)&&void 0!==t&&t.length),idleText:st("label.addWithIcon",{icon:i.createElement(Ne.Z,{icon:$e.IH})}),processingText:st("label.adding")})))})))}var ct=n(324176);function lt(e){var t=e.inheritsPermissions,n=(0,Ee.m)(),r=n.id,o=n.path,s=n.isModificationAllowed,a=n.documentRoomId,c=z(),l=(0,E.I4)({id:r,path:o,documentRoomId:a}).mutate,u=(0,i.useRef)(void 0);return i.createElement("div",{className:"oyBFJmTojAPPGoPgHOC4"},i.createElement(We.J9,{initialValues:{inheritsPermissions:t},enableReinitialize:!0,onSubmit:function(e){var n=e.inheritsPermissions;n!==t&&l({inheritsPermissions:n,keepParentPermissions:u.current,users:[],groups:[]},{onSuccess:function(){c(i.createElement(K,{inheritsPermissions:n,keepParentPermissions:u.current}))},onError:function(){c(i.createElement(W,{inheritsPermissions:n}))}})}},i.createElement(We.l0,null,i.createElement(ct.Z,{onRemovePermissionInheritance:function(e){var t=e.keepParentPermissions;u.current=t},onAddPermissionInheritance:function(){u.current=void 0},isModificationAllowed:s}))))}var ut=n(621465),mt=n(145218),dt=n(798399),pt=n(450155),ft=n(698607),Et=n(434986),vt=(0,m.nD)("storage.folderPermissions.accessRequest.denyModal");function Ot(e){var t=e.userName,n=e.onSubmit;return i.createElement(i.Fragment,null,i.createElement(s.ZP.Header,null,i.createElement(s.ZP.Title,null,vt("title"))),i.createElement(s.ZP.Body,null,i.createElement("p",null,vt("info")),i.createElement("p",null,vt("confirmation",{user:i.createElement("span",{className:"dPKZTEWmyz3LjILF9egz eugzcnL4uVMlgbRkfTqa"},t)}))),i.createElement(s.ZP.Footer,null,i.createElement(g.Z,{type:g.Z.SECONDARY,onClick:s.GZ},(0,m.t)("button.label.cancel")),i.createElement(g.Z,{onClick:function(){n(),(0,s.GZ)()},variant:g.Z.variants.DESTRUCTIVE},(0,m.t)("button.label.deny"))))}function bt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pt=function(e){var t=e.request,n=e.className,r=(0,mt.useQueryClient)(),o=z(),l=(0,i.useState)(nt.n.VIEWER.value),u=(0,y.Z)(l,2),d=u[0],p=u[1],f=(0,i.useState)(null),O=(0,y.Z)(f,2),b=O[0],P=O[1],R=t.folderAccessRequestId,Z=t.message,I=t.user,A=I.itemAvatar,h=(0,w.oY)(I),C=(0,Ee.m)(),N=C.id,D=C.path,j=C.emailFolderAccessRequestId,T=C.documentRoomId,_=C.isInInactiveContainer,M=(0,et.Z)({id:N,path:D,documentRoomId:T}),F=(0,ve.s)().addStatuses,L=(0,E.nJ)({id:N,path:D,documentRoomId:T}).mutate,q=(0,v.useAccessRequestReject)(R,j).mutateAsync,U=(0,v.useApproveAccessRequestWithPermission)({id:N,folderAccessRequestId:R,permissionValue:d,emailFolderAccessRequestId:j,path:D,documentRoomId:T},{onSuccess:function(){F([{id:t.user.id,mutation:S.lZ.ADDED}])}}).mutateAsync,x=function(){var e=(0,Qe.Z)(Ve().mark((function e(){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=3;break}return L({userId:I.id,groupId:b},{onSuccess:function(){F([{id:b,mutation:S.lZ.USER_ADDED}]),o(i.createElement(V,{groupName:d,userName:h})),a.Z.track(S.FP.ADD_TO_GROUP,yt({"From access request":!0},(0,c.zs)())),r.invalidateQueries(v.queryKeys.ACCESS_REQUEST_LIST)},onError:function(){o(i.createElement(ie,null))}}),e.abrupt("return");case 3:return e.prev=3,e.next=6,U();case 6:o(i.createElement(ae,null)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),o(i.createElement(ce,null));case 12:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(){return e.apply(this,arguments)}}(),G=j===t.folderAccessRequestId,Y=(0,i.useMemo)((function(){return i.createElement(i.Fragment,null,i.createElement("p",{className:"H1zGD1LYCkh7fNYYNEIo"},I.email),i.createElement("p",{className:"_MV6XjK_HRa8j3Tn0WlW"},(0,m.t)("storage.folderPermissions.label.".concat(I.typeName))))}),[I]);return i.createElement("div",{className:Ze()(n,G&&"GMduQslMegZCasJ303Om"),"data-tid":"request-item"},i.createElement("div",{className:"hboo_7prFpRxZoF2EHrJ"},i.createElement(ft.Z,{tooltip:Y,canCopy:!0,onClipboardCopy:function(){return I.email}},i.createElement("span",null,i.createElement(dt.Z,{acronym:(0,Et.e5)(I),src:A,size:dt.Z.sizes.S,color:dt.Z.colors.TEAL,active:G}))),i.createElement(k.Z,{"data-tid":"requester-name"},(0,m.t)("storage.folderPermissions.accessRequest.requester",{name:i.createElement("span",{className:"cacAFzAzkCxOp9lfz1ui eugzcnL4uVMlgbRkfTqa"},h)})),Z&&i.createElement("span",{"data-tid":"message-icon"},i.createElement(ft.Z,{tooltip:Z},i.createElement(Ne.Z,{icon:pt._P})))),i.createElement(Oe.Z,{item:yt(yt({},I),{},{permission:d,isRequester:!0}),onChange:function(e){P(""),p(e)},onAddToGroup:function(e,t){P(e),p(t)},groups:M,isInInactiveContainer:_}),i.createElement("div",{className:"uS2RgbtJCNHbnYdOWhfk"},i.createElement(g.Z,{type:g.Z.TERTIARY,onClick:function(){var e;!function(e){var t=e.userName,n=e.onSubmit;(0,s.Ll)(i.createElement(Ot,{userName:t,onSubmit:n}),{shouldCloseOnEsc:!1,shouldCloseOnOverlayClick:!1,size:s.ZP.sizes.AUTO,withCloseButton:!0,onRequestClose:function(){(0,s.GZ)()}})}({userName:h,onSubmit:(e=(0,Qe.Z)(Ve().mark((function e(){return Ve().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,q();case 3:o(i.createElement(se,null)),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),o(i.createElement(le,null));case 9:case"end":return e.stop()}}),e,null,[[0,6]])}))),function(){return e.apply(this,arguments)})})}},(0,m.t)("button.label.deny")),i.createElement(g.Z,{onClick:x},(0,m.t)("button.label.approve"))))},gt="E5rea0dcc754KC5OvT5g",Rt=(0,m.nD)("global.showMoreOrLessContent"),St=function(e){var t=e.requests,n=void 0===t?[]:t,o=(0,i.useState)(!1),s=(0,y.Z)(o,2),a=s[0],c=s[1],l=(0,i.useCallback)((function(e){e.preventDefault(),c((function(e){return!e}))}),[]);return i.createElement("div",{className:Ze()("GDgmlDNM9eZQkBpGkwzQ",a&&gt),"data-tid":"permission-requests-section"},n.map((function(e){return i.createElement(Pt,{key:e.folderAccessRequestId,className:Ze()("TUH_b4PMIGwUpc4keSvg",(0,r.Z)({},gt,a)),request:e})})),n.length>3&&i.createElement(g.Z,{type:g.Z.TERTIARY,onClick:l,className:"byChFpJ6huJ1K6Btamb4"},a?Rt("less"):Rt("moreWithNumber",{number:"".concat(n.length-3)}),i.createElement(g.Z.Icon,{icon:a?ut.m5:ut.Dd})))},Zt=n(224912),It=n(581355);function At(e){var t=e.disabled,n=e.onClick,r=(0,Ee.m)().documentRoomId;return i.createElement(ft.Z,{tooltip:(0,m.t)("storage.folderPermissions.userCreationLockedTooltip"),disabled:!t},i.createElement("div",{className:"mHAFrcxJh6kOAroFiYOi"},i.createElement(g.Z,{type:g.Z.TERTIARY,onClick:function(){return n({documentRoomId:r})},disabled:t,"data-tid":"invite-new-users"},i.createElement(g.Z.Icon,{icon:$e.hd}),(0,m.t)("storage.folderPermissions.inviteNewUsers")),t&&i.createElement(Ne.Z,{icon:It.yo,size:Ne.Z.sizes.M})))}var ht=function(e){var t=e.onCloseModal,n=(0,Zt.x)().canInviteNewUsers,r=(0,Ee.m)().isModificationAllowed,s=(0,x.nG)().openModal;return(0,i.useEffect)((function(){o.ZP.trigger(o.ZP.Events.Onboarding.UPLOAD_AND_SHARE.CLICK_INVITE_NEW_USERS_BUTTON)}),[]),i.createElement("div",{className:"sViuN7xA90yiPLlDsP4V"},i.createElement(g.Z,{type:g.Z.SECONDARY,onClick:t},(0,m.t)("button.label.close")),r&&n&&i.createElement("div",{"data-tid":"invite-new-user-onboarding-wrapper","data-onboarding":"[createSharedFolder.inviteUser_new] [uploadAndShare.clickInviteNewUsersButton]"},i.createElement(At,{disabled:!1,onClick:function(){a.Z.track(S.FP.INVITE_NEW,(0,c.zs)()),s({})}})))};function Ct(){var e=(0,Ee.m)().isModificationAllowed,t=z();return(0,i.useEffect)((function(){e||t(i.createElement(X,null))}),[t,e]),null}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var jt=(0,m.nD)("storage.folderPermissionsModal");function wt(e){var t=e.id,n=e.path,r=e.name,o=e.isModificationAllowed,a=e.emailFolderAccessRequestId,c=e.isInInactiveContainer,m=void 0!==c&&c,Z=e.documentRoomId,h=void 0===Z?null:Z,C=e.onModalClosed,N=(0,u.ZP)().data.workgroup.nonInheritedPermissionsEnabled,D=(0,b.Z)("folderAccessRequestEnabled"),j=(0,v.useAccessRequestsList)({id:t,options:{enabled:D,select:function(e){return a?function(e){var t=e.data,n=e.emailFolderAccessRequestId,r=t.findIndex((function(e){return e.folderAccessRequestId===n}));if(-1===r)return t;var o=t.splice(r,1),i=(0,y.Z)(o,1)[0];return t.unshift(i),t}({data:e,emailFolderAccessRequestId:a}):e}}}),w=j.data,T=void 0===w?[]:w,k=(0,E.v_)({path:n,id:t,documentRoomId:h,options:{select:function(e){return{permissions:[].concat((0,l.Z)((t=e.groups,t.map((function(e){return I(I({},e),{},{type:S.BX.GROUP})})))),(0,l.Z)(ze(e.users))).map((function(e,t){return Dt(Dt({},e),{},{originalIndex:t})})),inheritsPermissions:e.inheritsPermissions,permissionInheritanceEnabled:e.permissionInheritanceEnabled};var t}}}),_=k.isLoading,F=k.isFetching,L=k.data,q=void 0===L?{}:L,U=q.permissions,x=void 0===U?[]:U,G=q.inheritsPermissions,Y=void 0!==G&&G,z=q.permissionInheritanceEnabled,Q=D&&!!T.length,H=(0,P.O7)(n),V=N&&(null!=z?z:!H),W=function(){(0,s.Mr)(),null==C||C()},K=(0,O.EF)({documentRoomId:h,eventType:O.FJ.PORTAL_PERMISSION_MODAL_OPENED},{enabled:!!h}).isLoading;return i.createElement(Ee.D,{id:t,path:n,name:r,isModificationAllowed:o,emailFolderAccessRequestId:a,isInInactiveContainer:m,documentRoomId:h},i.createElement(M.nq,null,i.createElement(B,null,i.createElement(d.Z.Header,null,i.createElement(d.Z.Title,null,i.createElement("div",{className:"LBcR2I72PIIQJrHq97fg"},i.createElement("span",null,jt("title",{folder:r})),i.createElement(g.Z,{type:g.Z.TERTIARY,onClick:W},i.createElement(g.Z.Icon,{icon:R.xv}))))),i.createElement(d.Z.Body,null,_||K?i.createElement("div",{className:"Vjp5qk2bvEbfVdo9x4yj"},i.createElement(p.Z,null)):i.createElement("div",{className:"gZMvyfJFWadBT3LLWZUy"},i.createElement(me,null),Q&&i.createElement("div",{className:A},i.createElement(St,{requests:T}),i.createElement(f.Z,null)),V&&i.createElement("div",{className:A},i.createElement(lt,{inheritsPermissions:Y}),i.createElement(f.Z,null)),o&&i.createElement(at,{permissions:x}),i.createElement(Ge,{permissions:x,isModificationAllowed:o,isLoading:F}),i.createElement(Ct,null))),i.createElement(d.Z.Footer,null,!_&&i.createElement(ht,{onCloseModal:W})))))}function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(){o.ZP.trigger(o.ZP.Events.Onboarding.UPLOAD_AND_SHARE.STEPS_COMPLETED)}function _t(e){var t=e.path,n=e.name,o=e.id,l=e.documentRoomId,u=void 0===l?null:l,m=e.isModificationAllowed,d=e.emailFolderAccessRequestId,p=e.isInInactiveContainer,f=void 0!==p&&p,E=e.analyticsContext,v=void 0===E?"":E;a.Z.track(S.FP.OPEN,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({"From mail":!!d,Source:v},(0,c.zs)())),(0,s.h7)(i.createElement(wt,{path:t,name:n,id:o,isModificationAllowed:m,emailFolderAccessRequestId:d,isInInactiveContainer:f,documentRoomId:u,onModalClosed:kt}),{onRequestClose:function(){(0,s.Mr)(),kt()},withCloseButton:!1,size:s.ZP.sizes.XL})}}}]);